2014/06/04 11:55:27 [error] [exception.CException] exception 'CException' with message 'В классе Oms и его поведениях не найден метод или замыкание с именем "getNumRows".' in Z:\home\mis.my\yii\base\CComponent.php:266
Stack trace:
#0 Z:\home\mis.my\yii\db\ar\CActiveRecord.php(227): CComponent->__call('getNumRows', Array)
#1 Z:\home\mis.my\www\protected\modules\reception\controllers\PatientController.php(781): CActiveRecord->__call('getNumRows', Array)
#2 Z:\home\mis.my\www\protected\modules\reception\controllers\PatientController.php(781): Oms->getNumRows(Array, false, false, false, false, true, false, false)
#3 Z:\home\mis.my\yii\web\actions\CInlineAction.php(49): PatientController->actionSearch()
#4 Z:\home\mis.my\yii\web\CController.php(308): CInlineAction->runWithParams(Array)
#5 Z:\home\mis.my\yii\web\filters\CFilterChain.php(133): CController->runAction(Object(CInlineAction))
#6 Z:\home\mis.my\www\protected\components\Controller.php(33): CFilterChain->run()
#7 Z:\home\mis.my\yii\web\filters\CInlineFilter.php(58): Controller->filterGetAccessHierarchy(Object(CFilterChain))
#8 Z:\home\mis.my\yii\web\filters\CFilterChain.php(130): CInlineFilter->filter(Object(CFilterChain))
#9 Z:\home\mis.my\yii\web\CController.php(291): CFilterChain->run()
#10 Z:\home\mis.my\yii\web\CController.php(265): CController->runActionWithFilters(Object(CInlineAction), Array)
#11 Z:\home\mis.my\yii\web\CWebApplication.php(282): CController->run('search')
#12 Z:\home\mis.my\yii\web\CWebApplication.php(141): CWebApplication->runController('reception/patie...')
#13 Z:\home\mis.my\yii\base\CApplication.php(180): CWebApplication->processRequest()
#14 Z:\home\mis.my\www\index.php(13): CApplication->run()
#15 {main}
REQUEST_URI=/index.php/reception/patient/search/?withonly=0&filters={%22groupOp%22:%22AND%22,%22rules%22:[{%22field%22:%22oms_number%22,%22op%22:%22eq%22,%22data%22:%22123-456-7%22},{%22field%22:%22first_name%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22middle_name%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22last_name%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22address_reg_str%22,%22op%22:%22cn%22,%22data%22:%22%22},{%22field%22:%22address_str%22,%22op%22:%22cn%22,%22data%22:%22%22},{%22field%22:%22card_number%22,%22op%22:%22bw%22,%22data%22:%22%22},{%22field%22:%22serie%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22docnumber%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22snils%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22birthday%22,%22op%22:%22eq%22,%22data%22:%22%22}]}&rows=15&page=1&sidx=oms_number&sord=desc&_=1401866918065
HTTP_REFERER=http://mis.my/index.php/reception/patient/viewsearch
---
2014/06/04 11:55:27 [error] [exception.CException] exception 'CException' with message 'В классе Oms и его поведениях не найден метод или замыкание с именем "getNumRows".' in Z:\home\mis.my\yii\base\CComponent.php:266
Stack trace:
#0 Z:\home\mis.my\yii\db\ar\CActiveRecord.php(227): CComponent->__call('getNumRows', Array)
#1 Z:\home\mis.my\www\protected\modules\reception\controllers\PatientController.php(781): CActiveRecord->__call('getNumRows', Array)
#2 Z:\home\mis.my\www\protected\modules\reception\controllers\PatientController.php(781): Oms->getNumRows(Array, false, false, false, false, false, true, false)
#3 Z:\home\mis.my\yii\web\actions\CInlineAction.php(49): PatientController->actionSearch()
#4 Z:\home\mis.my\yii\web\CController.php(308): CInlineAction->runWithParams(Array)
#5 Z:\home\mis.my\yii\web\filters\CFilterChain.php(133): CController->runAction(Object(CInlineAction))
#6 Z:\home\mis.my\www\protected\components\Controller.php(33): CFilterChain->run()
#7 Z:\home\mis.my\yii\web\filters\CInlineFilter.php(58): Controller->filterGetAccessHierarchy(Object(CFilterChain))
#8 Z:\home\mis.my\yii\web\filters\CFilterChain.php(130): CInlineFilter->filter(Object(CFilterChain))
#9 Z:\home\mis.my\yii\web\CController.php(291): CFilterChain->run()
#10 Z:\home\mis.my\yii\web\CController.php(265): CController->runActionWithFilters(Object(CInlineAction), Array)
#11 Z:\home\mis.my\yii\web\CWebApplication.php(282): CController->run('search')
#12 Z:\home\mis.my\yii\web\CWebApplication.php(141): CWebApplication->runController('reception/patie...')
#13 Z:\home\mis.my\yii\base\CApplication.php(180): CWebApplication->processRequest()
#14 Z:\home\mis.my\www\index.php(13): CApplication->run()
#15 {main}
REQUEST_URI=/index.php/reception/patient/search/?withoutonly=0&filters={%22groupOp%22:%22AND%22,%22rules%22:[{%22field%22:%22oms_number%22,%22op%22:%22eq%22,%22data%22:%22123-456-7%22},{%22field%22:%22first_name%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22middle_name%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22last_name%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22address_reg_str%22,%22op%22:%22cn%22,%22data%22:%22%22},{%22field%22:%22address_str%22,%22op%22:%22cn%22,%22data%22:%22%22},{%22field%22:%22card_number%22,%22op%22:%22bw%22,%22data%22:%22%22},{%22field%22:%22serie%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22docnumber%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22snils%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22birthday%22,%22op%22:%22eq%22,%22data%22:%22%22}]}&rows=15&page=1&sidx=oms_number&sord=desc&_=1401866918066
HTTP_REFERER=http://mis.my/index.php/reception/patient/viewsearch
---
2014/06/04 13:07:40 [error] [system.db.CDbCommand] Не удалось выполнить CDbCommand::fetchAll(): SQLSTATE[42P10]: Invalid column reference: 7 ОШИБКА:  в конструкции SELECT DISTINCT выражения ORDER BY должны быть в списке выборки
LINE 5: ORDER BY "oms_number" DESC LIMIT 15
                 ^. Выполнявшийся SQL-запрос: SELECT DISTINCT "o"."id"
FROM "mis"."oms" "o"
LEFT JOIN "mis"."medcards" "m" ON o.id = m.policy_id
WHERE (o.oms_number = :oms_number) AND (coalesce(m.card_number,'')!='')
ORDER BY "oms_number" DESC LIMIT 15.
in Z:\home\mis.my\www\protected\models\Oms.php (179)
in Z:\home\mis.my\www\protected\modules\reception\controllers\PatientController.php (785)
in Z:\home\mis.my\www\protected\components\Controller.php (33)
2014/06/04 13:07:40 [error] [exception.CDbException] exception 'CDbException' with message 'CDbCommand не удалось исполнить SQL-запрос: SQLSTATE[42P10]: Invalid column reference: 7 ОШИБКА:  в конструкции SELECT DISTINCT выражения ORDER BY должны быть в списке выборки
LINE 5: ORDER BY "oms_number" DESC LIMIT 15
                 ^. The SQL statement executed was: SELECT DISTINCT "o"."id"
FROM "mis"."oms" "o"
LEFT JOIN "mis"."medcards" "m" ON o.id = m.policy_id
WHERE (o.oms_number = :oms_number) AND (coalesce(m.card_number,'')!='')
ORDER BY "oms_number" DESC LIMIT 15' in Z:\home\mis.my\yii\db\CDbCommand.php:543
Stack trace:
#0 Z:\home\mis.my\yii\db\CDbCommand.php(396): CDbCommand->queryInternal('fetchAll', Array, Array)
#1 Z:\home\mis.my\www\protected\models\Oms.php(179): CDbCommand->queryAll()
#2 Z:\home\mis.my\www\protected\modules\reception\controllers\PatientController.php(785): Oms->getRows(Array, 'oms_number', 'desc', 0, '15', true, false, false)
#3 Z:\home\mis.my\yii\web\actions\CInlineAction.php(49): PatientController->actionSearch()
#4 Z:\home\mis.my\yii\web\CController.php(308): CInlineAction->runWithParams(Array)
#5 Z:\home\mis.my\yii\web\filters\CFilterChain.php(133): CController->runAction(Object(CInlineAction))
#6 Z:\home\mis.my\www\protected\components\Controller.php(33): CFilterChain->run()
#7 Z:\home\mis.my\yii\web\filters\CInlineFilter.php(58): Controller->filterGetAccessHierarchy(Object(CFilterChain))
#8 Z:\home\mis.my\yii\web\filters\CFilterChain.php(130): CInlineFilter->filter(Object(CFilterChain))
#9 Z:\home\mis.my\yii\web\CController.php(291): CFilterChain->run()
#10 Z:\home\mis.my\yii\web\CController.php(265): CController->runActionWithFilters(Object(CInlineAction), Array)
#11 Z:\home\mis.my\yii\web\CWebApplication.php(282): CController->run('search')
#12 Z:\home\mis.my\yii\web\CWebApplication.php(141): CWebApplication->runController('reception/patie...')
#13 Z:\home\mis.my\yii\base\CApplication.php(180): CWebApplication->processRequest()
#14 Z:\home\mis.my\www\index.php(13): CApplication->run()
#15 {main}
REQUEST_URI=/index.php/reception/patient/search/?withonly=0&filters={%22groupOp%22:%22AND%22,%22rules%22:[{%22field%22:%22oms_number%22,%22op%22:%22eq%22,%22data%22:%22123-456-7%22},{%22field%22:%22first_name%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22middle_name%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22last_name%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22address_reg_str%22,%22op%22:%22cn%22,%22data%22:%22%22},{%22field%22:%22address_str%22,%22op%22:%22cn%22,%22data%22:%22%22},{%22field%22:%22card_number%22,%22op%22:%22bw%22,%22data%22:%22%22},{%22field%22:%22serie%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22docnumber%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22snils%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22birthday%22,%22op%22:%22eq%22,%22data%22:%22%22}]}&rows=15&page=1&sidx=oms_number&sord=desc&_=1401872855370
HTTP_REFERER=http://mis.my/index.php/reception/patient/viewsearch
---
2014/06/04 13:07:40 [error] [system.db.CDbCommand] Не удалось выполнить CDbCommand::fetchAll(): SQLSTATE[42P10]: Invalid column reference: 7 ОШИБКА:  в конструкции SELECT DISTINCT выражения ORDER BY должны быть в списке выборки
LINE 5: ORDER BY "oms_number" DESC LIMIT 15
                 ^. Выполнявшийся SQL-запрос: SELECT DISTINCT "o"."id"
FROM "mis"."oms" "o"
LEFT JOIN "mis"."medcards" "m" ON o.id = m.policy_id
WHERE (o.oms_number = :oms_number) AND (coalesce(m.card_number,'')='')
ORDER BY "oms_number" DESC LIMIT 15.
in Z:\home\mis.my\www\protected\models\Oms.php (179)
in Z:\home\mis.my\www\protected\modules\reception\controllers\PatientController.php (785)
in Z:\home\mis.my\www\protected\components\Controller.php (33)
2014/06/04 13:07:40 [error] [exception.CDbException] exception 'CDbException' with message 'CDbCommand не удалось исполнить SQL-запрос: SQLSTATE[42P10]: Invalid column reference: 7 ОШИБКА:  в конструкции SELECT DISTINCT выражения ORDER BY должны быть в списке выборки
LINE 5: ORDER BY "oms_number" DESC LIMIT 15
                 ^. The SQL statement executed was: SELECT DISTINCT "o"."id"
FROM "mis"."oms" "o"
LEFT JOIN "mis"."medcards" "m" ON o.id = m.policy_id
WHERE (o.oms_number = :oms_number) AND (coalesce(m.card_number,'')='')
ORDER BY "oms_number" DESC LIMIT 15' in Z:\home\mis.my\yii\db\CDbCommand.php:543
Stack trace:
#0 Z:\home\mis.my\yii\db\CDbCommand.php(396): CDbCommand->queryInternal('fetchAll', Array, Array)
#1 Z:\home\mis.my\www\protected\models\Oms.php(179): CDbCommand->queryAll()
#2 Z:\home\mis.my\www\protected\modules\reception\controllers\PatientController.php(785): Oms->getRows(Array, 'oms_number', 'desc', 0, '15', false, true, false)
#3 Z:\home\mis.my\yii\web\actions\CInlineAction.php(49): PatientController->actionSearch()
#4 Z:\home\mis.my\yii\web\CController.php(308): CInlineAction->runWithParams(Array)
#5 Z:\home\mis.my\yii\web\filters\CFilterChain.php(133): CController->runAction(Object(CInlineAction))
#6 Z:\home\mis.my\www\protected\components\Controller.php(33): CFilterChain->run()
#7 Z:\home\mis.my\yii\web\filters\CInlineFilter.php(58): Controller->filterGetAccessHierarchy(Object(CFilterChain))
#8 Z:\home\mis.my\yii\web\filters\CFilterChain.php(130): CInlineFilter->filter(Object(CFilterChain))
#9 Z:\home\mis.my\yii\web\CController.php(291): CFilterChain->run()
#10 Z:\home\mis.my\yii\web\CController.php(265): CController->runActionWithFilters(Object(CInlineAction), Array)
#11 Z:\home\mis.my\yii\web\CWebApplication.php(282): CController->run('search')
#12 Z:\home\mis.my\yii\web\CWebApplication.php(141): CWebApplication->runController('reception/patie...')
#13 Z:\home\mis.my\yii\base\CApplication.php(180): CWebApplication->processRequest()
#14 Z:\home\mis.my\www\index.php(13): CApplication->run()
#15 {main}
REQUEST_URI=/index.php/reception/patient/search/?withoutonly=0&filters={%22groupOp%22:%22AND%22,%22rules%22:[{%22field%22:%22oms_number%22,%22op%22:%22eq%22,%22data%22:%22123-456-7%22},{%22field%22:%22first_name%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22middle_name%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22last_name%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22address_reg_str%22,%22op%22:%22cn%22,%22data%22:%22%22},{%22field%22:%22address_str%22,%22op%22:%22cn%22,%22data%22:%22%22},{%22field%22:%22card_number%22,%22op%22:%22bw%22,%22data%22:%22%22},{%22field%22:%22serie%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22docnumber%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22snils%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22birthday%22,%22op%22:%22eq%22,%22data%22:%22%22}]}&rows=15&page=1&sidx=oms_number&sord=desc&_=1401872855371
HTTP_REFERER=http://mis.my/index.php/reception/patient/viewsearch
---
2014/06/04 13:09:43 [error] [php] Undefined index: id (Z:\home\mis.my\www\protected\models\Oms.php:253)
Stack trace:
#0 Z:\home\mis.my\yii\web\CController.php(308): CInlineAction->runWithParams()
#1 Z:\home\mis.my\yii\web\filters\CFilterChain.php(133): PatientController->runAction()
#2 Z:\home\mis.my\www\protected\components\Controller.php(33): CFilterChain->run()
#3 Z:\home\mis.my\yii\web\filters\CInlineFilter.php(58): PatientController->filterGetAccessHierarchy()
#4 Z:\home\mis.my\yii\web\filters\CFilterChain.php(130): CInlineFilter->filter()
#5 Z:\home\mis.my\yii\web\CController.php(291): CFilterChain->run()
#6 Z:\home\mis.my\yii\web\CController.php(265): PatientController->runActionWithFilters()
#7 Z:\home\mis.my\yii\web\CWebApplication.php(282): PatientController->run()
#8 Z:\home\mis.my\yii\web\CWebApplication.php(141): CWebApplication->runController()
#9 Z:\home\mis.my\yii\base\CApplication.php(180): CWebApplication->processRequest()
#10 Z:\home\mis.my\www\index.php(13): CWebApplication->run()
REQUEST_URI=/index.php/reception/patient/search/?withonly=0&filters={%22groupOp%22:%22AND%22,%22rules%22:[{%22field%22:%22oms_number%22,%22op%22:%22eq%22,%22data%22:%22123-456-7%22},{%22field%22:%22first_name%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22middle_name%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22last_name%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22address_reg_str%22,%22op%22:%22cn%22,%22data%22:%22%22},{%22field%22:%22address_str%22,%22op%22:%22cn%22,%22data%22:%22%22},{%22field%22:%22card_number%22,%22op%22:%22bw%22,%22data%22:%22%22},{%22field%22:%22serie%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22docnumber%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22snils%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22birthday%22,%22op%22:%22eq%22,%22data%22:%22%22}]}&rows=15&page=1&sidx=oms_number&sord=desc&_=1401872977193
in Z:\home\mis.my\www\protected\models\Oms.php (253)
in Z:\home\mis.my\www\protected\modules\reception\controllers\PatientController.php (785)
in Z:\home\mis.my\www\protected\components\Controller.php (33)
2014/06/04 13:16:47 [error] [php] Undefined index: reg_date (Z:\home\mis.my\www\protected\modules\reception\controllers\PatientController.php:789)
Stack trace:
#0 Z:\home\mis.my\yii\web\filters\CFilterChain.php(133): PatientController->runAction()
#1 Z:\home\mis.my\www\protected\components\Controller.php(33): CFilterChain->run()
#2 Z:\home\mis.my\yii\web\filters\CInlineFilter.php(58): PatientController->filterGetAccessHierarchy()
#3 Z:\home\mis.my\yii\web\filters\CFilterChain.php(130): CInlineFilter->filter()
#4 Z:\home\mis.my\yii\web\CController.php(291): CFilterChain->run()
#5 Z:\home\mis.my\yii\web\CController.php(265): PatientController->runActionWithFilters()
#6 Z:\home\mis.my\yii\web\CWebApplication.php(282): PatientController->run()
#7 Z:\home\mis.my\yii\web\CWebApplication.php(141): CWebApplication->runController()
#8 Z:\home\mis.my\yii\base\CApplication.php(180): CWebApplication->processRequest()
#9 Z:\home\mis.my\www\index.php(13): CWebApplication->run()
REQUEST_URI=/index.php/reception/patient/search/?withonly=0&filters={%22groupOp%22:%22AND%22,%22rules%22:[{%22field%22:%22oms_number%22,%22op%22:%22eq%22,%22data%22:%22123-456-7%22},{%22field%22:%22first_name%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22middle_name%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22last_name%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22address_reg_str%22,%22op%22:%22cn%22,%22data%22:%22%22},{%22field%22:%22address_str%22,%22op%22:%22cn%22,%22data%22:%22%22},{%22field%22:%22card_number%22,%22op%22:%22bw%22,%22data%22:%22%22},{%22field%22:%22serie%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22docnumber%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22snils%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22birthday%22,%22op%22:%22eq%22,%22data%22:%22%22}]}&rows=15&page=1&sidx=oms_number&sord=desc&_=1401873404696
in Z:\home\mis.my\www\protected\modules\reception\controllers\PatientController.php (789)
in Z:\home\mis.my\www\protected\components\Controller.php (33)
in Z:\home\mis.my\www\index.php (13)
2014/06/04 15:44:07 [error] [system.db.CDbCommand] Не удалось выполнить CDbCommand::fetchAll(): SQLSTATE[22P02]: Invalid text representation: 7 ОШИБКА:  неверное значение для целого числа: "73,68,72,69,70,71,56,55,49". Выполнявшийся SQL-запрос: SELECT o.*,
                            (
                                    SELECT
                                    m.card_number
                                    FROM mis.medcards m
                                    WHERE	(
                                            substring(m.card_number, (char_length(m.card_number)-2) , (char_length(m.card_number))  )
                                            =
                                            (
                                                SELECT
                                                MAX
                                                (
                                                    substring(m2.card_number , char_length(m2.card_number)-2 , char_length(m2.card_number)  )
                                                )
                                                FROM mis.medcards m2
                                                WHERE ( m2.policy_id=o.id  )

                                            )
                                        )
                                        AND
                                        (
                                            m.policy_id = o.id

                                        )
                                 ) as card_number,
                                 (
                                    SELECT MAX(m3.reg_date)
                                    FROM mis.medcards m3
                                    WHERE m3.policy_id = o.id
                                 ) as reg_date

                
FROM "mis"."oms" "o"
WHERE id in (:policy_ids).
in Z:\home\mis.my\www\protected\models\Oms.php (244)
in Z:\home\mis.my\www\protected\modules\reception\controllers\PatientController.php (785)
in Z:\home\mis.my\www\protected\components\Controller.php (33)
2014/06/04 15:44:07 [error] [exception.CDbException] exception 'CDbException' with message 'CDbCommand не удалось исполнить SQL-запрос: SQLSTATE[22P02]: Invalid text representation: 7 ОШИБКА:  неверное значение для целого числа: "73,68,72,69,70,71,56,55,49". The SQL statement executed was: SELECT o.*,
                            (
                                    SELECT
                                    m.card_number
                                    FROM mis.medcards m
                                    WHERE	(
                                            substring(m.card_number, (char_length(m.card_number)-2) , (char_length(m.card_number))  )
                                            =
                                            (
                                                SELECT
                                                MAX
                                                (
                                                    substring(m2.card_number , char_length(m2.card_number)-2 , char_length(m2.card_number)  )
                                                )
                                                FROM mis.medcards m2
                                                WHERE ( m2.policy_id=o.id  )

                                            )
                                        )
                                        AND
                                        (
                                            m.policy_id = o.id

                                        )
                                 ) as card_number,
                                 (
                                    SELECT MAX(m3.reg_date)
                                    FROM mis.medcards m3
                                    WHERE m3.policy_id = o.id
                                 ) as reg_date

                
FROM "mis"."oms" "o"
WHERE id in (:policy_ids)' in Z:\home\mis.my\yii\db\CDbCommand.php:543
Stack trace:
#0 Z:\home\mis.my\yii\db\CDbCommand.php(396): CDbCommand->queryInternal('fetchAll', Array, Array)
#1 Z:\home\mis.my\www\protected\models\Oms.php(244): CDbCommand->queryAll()
#2 Z:\home\mis.my\www\protected\modules\reception\controllers\PatientController.php(785): Oms->getRows(Array, 'oms_number', 'desc', 0, '15', true, false, false)
#3 Z:\home\mis.my\yii\web\actions\CInlineAction.php(49): PatientController->actionSearch()
#4 Z:\home\mis.my\yii\web\CController.php(308): CInlineAction->runWithParams(Array)
#5 Z:\home\mis.my\yii\web\filters\CFilterChain.php(133): CController->runAction(Object(CInlineAction))
#6 Z:\home\mis.my\www\protected\components\Controller.php(33): CFilterChain->run()
#7 Z:\home\mis.my\yii\web\filters\CInlineFilter.php(58): Controller->filterGetAccessHierarchy(Object(CFilterChain))
#8 Z:\home\mis.my\yii\web\filters\CFilterChain.php(130): CInlineFilter->filter(Object(CFilterChain))
#9 Z:\home\mis.my\yii\web\CController.php(291): CFilterChain->run()
#10 Z:\home\mis.my\yii\web\CController.php(265): CController->runActionWithFilters(Object(CInlineAction), Array)
#11 Z:\home\mis.my\yii\web\CWebApplication.php(282): CController->run('search')
#12 Z:\home\mis.my\yii\web\CWebApplication.php(141): CWebApplication->runController('reception/patie...')
#13 Z:\home\mis.my\yii\base\CApplication.php(180): CWebApplication->processRequest()
#14 Z:\home\mis.my\www\index.php(13): CApplication->run()
#15 {main}
REQUEST_URI=/index.php/reception/patient/search/?withonly=0&filters={%22groupOp%22:%22AND%22,%22rules%22:[{%22field%22:%22oms_number%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22first_name%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22middle_name%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22last_name%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22address_reg_str%22,%22op%22:%22cn%22,%22data%22:%22%22},{%22field%22:%22address_str%22,%22op%22:%22cn%22,%22data%22:%22%22},{%22field%22:%22card_number%22,%22op%22:%22bw%22,%22data%22:%221%22},{%22field%22:%22serie%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22docnumber%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22snils%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22birthday%22,%22op%22:%22eq%22,%22data%22:%22%22}]}&rows=15&page=1&sidx=oms_number&sord=desc&_=1401882090733
HTTP_REFERER=http://mis.my/index.php/reception/patient/writepatientstepone
---
2014/06/04 15:44:33 [error] [system.db.CDbCommand] Не удалось выполнить CDbCommand::fetchAll(): SQLSTATE[22P02]: Invalid text representation: 7 ОШИБКА:  неверное значение для целого числа: "73,68,72,69,70,71,56,55,49". Выполнявшийся SQL-запрос: SELECT o.*,
                            (
                                    SELECT
                                    m.card_number
                                    FROM mis.medcards m
                                    WHERE	(
                                            substring(m.card_number, (char_length(m.card_number)-2) , (char_length(m.card_number))  )
                                            =
                                            (
                                                SELECT
                                                MAX
                                                (
                                                    substring(m2.card_number , char_length(m2.card_number)-2 , char_length(m2.card_number)  )
                                                )
                                                FROM mis.medcards m2
                                                WHERE ( m2.policy_id=o.id  )

                                            )
                                        )
                                        AND
                                        (
                                            m.policy_id = o.id

                                        )
                                 ) as card_number,
                                 (
                                    SELECT MAX(m3.reg_date)
                                    FROM mis.medcards m3
                                    WHERE m3.policy_id = o.id
                                 ) as reg_date

                
FROM "mis"."oms" "o"
WHERE id in (:policy_ids).
in Z:\home\mis.my\www\protected\models\Oms.php (244)
in Z:\home\mis.my\www\protected\modules\reception\controllers\PatientController.php (785)
in Z:\home\mis.my\www\protected\components\Controller.php (33)
2014/06/04 15:44:33 [error] [exception.CDbException] exception 'CDbException' with message 'CDbCommand не удалось исполнить SQL-запрос: SQLSTATE[22P02]: Invalid text representation: 7 ОШИБКА:  неверное значение для целого числа: "73,68,72,69,70,71,56,55,49". The SQL statement executed was: SELECT o.*,
                            (
                                    SELECT
                                    m.card_number
                                    FROM mis.medcards m
                                    WHERE	(
                                            substring(m.card_number, (char_length(m.card_number)-2) , (char_length(m.card_number))  )
                                            =
                                            (
                                                SELECT
                                                MAX
                                                (
                                                    substring(m2.card_number , char_length(m2.card_number)-2 , char_length(m2.card_number)  )
                                                )
                                                FROM mis.medcards m2
                                                WHERE ( m2.policy_id=o.id  )

                                            )
                                        )
                                        AND
                                        (
                                            m.policy_id = o.id

                                        )
                                 ) as card_number,
                                 (
                                    SELECT MAX(m3.reg_date)
                                    FROM mis.medcards m3
                                    WHERE m3.policy_id = o.id
                                 ) as reg_date

                
FROM "mis"."oms" "o"
WHERE id in (:policy_ids)' in Z:\home\mis.my\yii\db\CDbCommand.php:543
Stack trace:
#0 Z:\home\mis.my\yii\db\CDbCommand.php(396): CDbCommand->queryInternal('fetchAll', Array, Array)
#1 Z:\home\mis.my\www\protected\models\Oms.php(244): CDbCommand->queryAll()
#2 Z:\home\mis.my\www\protected\modules\reception\controllers\PatientController.php(785): Oms->getRows(Array, 'oms_number', 'desc', 0, '15', true, false, false)
#3 Z:\home\mis.my\yii\web\actions\CInlineAction.php(49): PatientController->actionSearch()
#4 Z:\home\mis.my\yii\web\CController.php(308): CInlineAction->runWithParams(Array)
#5 Z:\home\mis.my\yii\web\filters\CFilterChain.php(133): CController->runAction(Object(CInlineAction))
#6 Z:\home\mis.my\www\protected\components\Controller.php(33): CFilterChain->run()
#7 Z:\home\mis.my\yii\web\filters\CInlineFilter.php(58): Controller->filterGetAccessHierarchy(Object(CFilterChain))
#8 Z:\home\mis.my\yii\web\filters\CFilterChain.php(130): CInlineFilter->filter(Object(CFilterChain))
#9 Z:\home\mis.my\yii\web\CController.php(291): CFilterChain->run()
#10 Z:\home\mis.my\yii\web\CController.php(265): CController->runActionWithFilters(Object(CInlineAction), Array)
#11 Z:\home\mis.my\yii\web\CWebApplication.php(282): CController->run('search')
#12 Z:\home\mis.my\yii\web\CWebApplication.php(141): CWebApplication->runController('reception/patie...')
#13 Z:\home\mis.my\yii\base\CApplication.php(180): CWebApplication->processRequest()
#14 Z:\home\mis.my\www\index.php(13): CApplication->run()
#15 {main}
REQUEST_URI=/index.php/reception/patient/search/?withonly=0&filters={%22groupOp%22:%22AND%22,%22rules%22:[{%22field%22:%22oms_number%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22first_name%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22middle_name%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22last_name%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22address_reg_str%22,%22op%22:%22cn%22,%22data%22:%22%22},{%22field%22:%22address_str%22,%22op%22:%22cn%22,%22data%22:%22%22},{%22field%22:%22card_number%22,%22op%22:%22bw%22,%22data%22:%221%22},{%22field%22:%22serie%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22docnumber%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22snils%22,%22op%22:%22eq%22,%22data%22:%22%22},{%22field%22:%22birthday%22,%22op%22:%22eq%22,%22data%22:%22%22}]}&rows=15&page=1&sidx=oms_number&sord=desc&_=1401882264215
HTTP_REFERER=http://mis.my/index.php/reception/patient/writepatientstepone
---
2014/06/04 16:45:59 [error] [system.db.CDbCommand] Не удалось выполнить CDbCommand::execute(): SQLSTATE[23503]: Foreign key violation: 7 ОШИБКА:  UPDATE или DELETE в таблице "enterprise_params" нарушает ограничение внешнего ключа "cabinets_enterprise_id_fkey" таблицы "cabinets"
DETAIL:  На ключ (id)=(8) всё ещё есть ссылки в таблице "cabinets".. Выполнявшийся SQL-запрос: DELETE FROM "mis"."enterprise_params" WHERE "mis"."enterprise_params"."id"=8.
in Z:\home\mis.my\www\protected\modules\guides\controllers\EnterprisesController.php (69)
in Z:\home\mis.my\www\protected\components\Controller.php (33)
in Z:\home\mis.my\www\index.php (13)
2014/06/04 18:34:29 [error] [exception.CHttpException.400] exception 'CHttpException' with message 'Некорректный запрос.' in Z:\home\mis.my\yii\web\CController.php:336
Stack trace:
#0 Z:\home\mis.my\yii\web\CController.php(309): CController->invalidActionParams(Object(CInlineAction))
#1 Z:\home\mis.my\yii\web\filters\CFilterChain.php(133): CController->runAction(Object(CInlineAction))
#2 Z:\home\mis.my\www\protected\components\Controller.php(33): CFilterChain->run()
#3 Z:\home\mis.my\yii\web\filters\CInlineFilter.php(58): Controller->filterGetAccessHierarchy(Object(CFilterChain))
#4 Z:\home\mis.my\yii\web\filters\CFilterChain.php(130): CInlineFilter->filter(Object(CFilterChain))
#5 Z:\home\mis.my\yii\web\CController.php(291): CFilterChain->run()
#6 Z:\home\mis.my\yii\web\CController.php(265): CController->runActionWithFilters(Object(CInlineAction), Array)
#7 Z:\home\mis.my\yii\web\CWebApplication.php(282): CController->run('changegreetings...')
#8 Z:\home\mis.my\yii\web\CWebApplication.php(141): CWebApplication->runController('doctors/shedule...')
#9 Z:\home\mis.my\yii\base\CApplication.php(180): CWebApplication->processRequest()
#10 Z:\home\mis.my\www\index.php(13): CApplication->run()
#11 {main}
REQUEST_URI=/index.php/doctors/shedule/changegreetingstatus?greetingId=562&newValue=0&_=1401892464076
HTTP_REFERER=http://mis.my/index.php/doctors/shedule/view
---
2014/06/04 18:36:26 [error] [exception.CHttpException.400] exception 'CHttpException' with message 'Некорректный запрос.' in Z:\home\mis.my\yii\web\CController.php:336
Stack trace:
#0 Z:\home\mis.my\yii\web\CController.php(309): CController->invalidActionParams(Object(CInlineAction))
#1 Z:\home\mis.my\yii\web\filters\CFilterChain.php(133): CController->runAction(Object(CInlineAction))
#2 Z:\home\mis.my\www\protected\components\Controller.php(33): CFilterChain->run()
#3 Z:\home\mis.my\yii\web\filters\CInlineFilter.php(58): Controller->filterGetAccessHierarchy(Object(CFilterChain))
#4 Z:\home\mis.my\yii\web\filters\CFilterChain.php(130): CInlineFilter->filter(Object(CFilterChain))
#5 Z:\home\mis.my\yii\web\CController.php(291): CFilterChain->run()
#6 Z:\home\mis.my\yii\web\CController.php(265): CController->runActionWithFilters(Object(CInlineAction), Array)
#7 Z:\home\mis.my\yii\web\CWebApplication.php(282): CController->run('changegreetings...')
#8 Z:\home\mis.my\yii\web\CWebApplication.php(141): CWebApplication->runController('doctors/shedule...')
#9 Z:\home\mis.my\yii\base\CApplication.php(180): CWebApplication->processRequest()
#10 Z:\home\mis.my\www\index.php(13): CApplication->run()
#11 {main}
REQUEST_URI=/index.php/doctors/shedule/changegreetingstatus?greetingId=562&newValue=0&_=1401892583083
HTTP_REFERER=http://mis.my/index.php/doctors/shedule/view
---
2014/06/05 11:43:06 [error] [php] A non well formed numeric value encountered (Z:\home\mis.my\www\protected\modules\doctors\components\widgets\views\PatientListWidget.php:5)
Stack trace:
#0 Z:\home\mis.my\yii\web\CBaseController.php(95): PatientListWidget->renderInternal()
#1 Z:\home\mis.my\yii\web\widgets\CWidget.php(244): PatientListWidget->renderFile()
#2 Z:\home\mis.my\www\protected\modules\doctors\components\widgets\PatientListWidget.php(21): PatientListWidget->render()
#3 Z:\home\mis.my\yii\web\CBaseController.php(173): PatientListWidget->run()
#4 Z:\home\mis.my\www\protected\modules\doctors\views\shedule\index.php(185): SheduleController->widget()
#5 Z:\home\mis.my\yii\web\CBaseController.php(126): require()
#6 Z:\home\mis.my\yii\web\CBaseController.php(95): SheduleController->renderInternal()
#7 Z:\home\mis.my\yii\web\CController.php(869): SheduleController->renderFile()
#8 Z:\home\mis.my\yii\web\CController.php(782): SheduleController->renderPartial()
#9 Z:\home\mis.my\www\protected\modules\doctors\controllers\SheduleController.php(173): SheduleController->render()
#10 Z:\home\mis.my\yii\web\actions\CInlineAction.php(49): SheduleController->actionView()
#11 Z:\home\mis.my\yii\web\CController.php(308): CInlineAction->runWithParams()
#12 Z:\home\mis.my\yii\web\filters\CFilterChain.php(133): SheduleController->runAction()
#13 Z:\home\mis.my\www\protected\components\Controller.php(33): CFilterChain->run()
#14 Z:\home\mis.my\yii\web\filters\CInlineFilter.php(58): SheduleController->filterGetAccessHierarchy()
#15 Z:\home\mis.my\yii\web\filters\CFilterChain.php(130): CInlineFilter->filter()
#16 Z:\home\mis.my\yii\web\CController.php(291): CFilterChain->run()
#17 Z:\home\mis.my\yii\web\CController.php(265): SheduleController->runActionWithFilters()
#18 Z:\home\mis.my\yii\web\CWebApplication.php(282): SheduleController->run()
#19 Z:\home\mis.my\yii\web\CWebApplication.php(141): CWebApplication->runController()
#20 Z:\home\mis.my\yii\base\CApplication.php(180): CWebApplication->processRequest()
#21 Z:\home\mis.my\www\index.php(13): CWebApplication->run()
REQUEST_URI=/index.php/doctors/shedule/view?cardid=1/13&date=2014-6-11&rowid=560
in Z:\home\mis.my\www\protected\modules\doctors\components\widgets\views\PatientListWidget.php (5)
in Z:\home\mis.my\www\protected\modules\doctors\components\widgets\PatientListWidget.php (21)
in Z:\home\mis.my\www\protected\modules\doctors\views\shedule\index.php (185)
2014/06/05 11:50:35 [error] [php] A non well formed numeric value encountered (Z:\home\mis.my\www\protected\modules\doctors\components\widgets\views\PatientListWidget.php:6)
Stack trace:
#0 Z:\home\mis.my\yii\web\CBaseController.php(95): PatientListWidget->renderInternal()
#1 Z:\home\mis.my\yii\web\widgets\CWidget.php(244): PatientListWidget->renderFile()
#2 Z:\home\mis.my\www\protected\modules\doctors\components\widgets\PatientListWidget.php(21): PatientListWidget->render()
#3 Z:\home\mis.my\yii\web\CBaseController.php(173): PatientListWidget->run()
#4 Z:\home\mis.my\www\protected\modules\doctors\views\shedule\index.php(185): SheduleController->widget()
#5 Z:\home\mis.my\yii\web\CBaseController.php(126): require()
#6 Z:\home\mis.my\yii\web\CBaseController.php(95): SheduleController->renderInternal()
#7 Z:\home\mis.my\yii\web\CController.php(869): SheduleController->renderFile()
#8 Z:\home\mis.my\yii\web\CController.php(782): SheduleController->renderPartial()
#9 Z:\home\mis.my\www\protected\modules\doctors\controllers\SheduleController.php(173): SheduleController->render()
#10 Z:\home\mis.my\yii\web\actions\CInlineAction.php(49): SheduleController->actionView()
#11 Z:\home\mis.my\yii\web\CController.php(308): CInlineAction->runWithParams()
#12 Z:\home\mis.my\yii\web\filters\CFilterChain.php(133): SheduleController->runAction()
#13 Z:\home\mis.my\www\protected\components\Controller.php(33): CFilterChain->run()
#14 Z:\home\mis.my\yii\web\filters\CInlineFilter.php(58): SheduleController->filterGetAccessHierarchy()
#15 Z:\home\mis.my\yii\web\filters\CFilterChain.php(130): CInlineFilter->filter()
#16 Z:\home\mis.my\yii\web\CController.php(291): CFilterChain->run()
#17 Z:\home\mis.my\yii\web\CController.php(265): SheduleController->runActionWithFilters()
#18 Z:\home\mis.my\yii\web\CWebApplication.php(282): SheduleController->run()
#19 Z:\home\mis.my\yii\web\CWebApplication.php(141): CWebApplication->runController()
#20 Z:\home\mis.my\yii\base\CApplication.php(180): CWebApplication->processRequest()
#21 Z:\home\mis.my\www\index.php(13): CWebApplication->run()
REQUEST_URI=/index.php/doctors/shedule/view?cardid=1/13&date=2014-6-11&rowid=560
in Z:\home\mis.my\www\protected\modules\doctors\components\widgets\views\PatientListWidget.php (6)
in Z:\home\mis.my\www\protected\modules\doctors\components\widgets\PatientListWidget.php (21)
in Z:\home\mis.my\www\protected\modules\doctors\views\shedule\index.php (185)
